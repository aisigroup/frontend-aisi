(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[490],{285:(e,t,a)=>{"use strict";a.d(t,{$:()=>l});var r=a(5155),n=a(2115),s=a(9708),i=a(2085),o=a(9434);let d=(0,i.F)("inline-flex items-center cursor-pointer justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow ",destructive:"bg-white border-[red] border text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:a,variant:n,size:i,asChild:l=!1,...c}=e,u=l?s.DX:"button";return(0,r.jsx)(u,{className:(0,o.cn)(d({variant:n,size:i,className:a})),ref:t,...c})});l.displayName="Button"},768:(e,t,a)=>{"use strict";a.d(t,{S:()=>r});let r=a(3464).A.create({baseURL:"http://localhost:3001/api",withCredentials:!0,headers:{"Content-Type":"application/json"}})},2012:(e,t,a)=>{"use strict";a.d(t,{default:()=>N});var r=a(5155),n=a(4165),s=a(285),i=a(2523),o=a(5365),d=a(4631),l=a(4616),c=a(8136),u=a(2525),g=a(6715),f=a(9373),p=a(5041),m=a(768);let h={post:async e=>(await m.S.post("/add_building",e)).data,get:async()=>(await m.S.get("/buildings")).data,delete:async e=>(await m.S.delete("/delete_building/".concat(e))).data};var x=a(2115),v=a(6671),b=a(9335),y=a(6874),j=a.n(y),w=a(5695);function N(){let{logout:e}=(0,b.A)(),t=(0,g.jE)(),a=(0,w.usePathname)(),[m,y]=(0,x.useState)(""),[N,k]=(0,x.useState)(""),[C,A]=(0,x.useState)(!1),[S,E]=(0,x.useState)(""),[_,z]=(0,x.useState)(null),[F,R]=(0,x.useState)(null),{data:B=[],isLoading:P}=(0,f.I)({queryKey:["buildings"],queryFn:async()=>(await h.get()).data,staleTime:3e4,gcTime:3e5,retry:1,refetchOnWindowFocus:!0,refetchOnMount:!0}),D=(0,x.useCallback)(()=>{t.prefetchQuery({queryKey:["buildings"],queryFn:async()=>(await h.get()).data,staleTime:3e4})},[t]),U=e=>"Adminuser111"===e,I=(0,p.n)({mutationFn:async()=>{if(!m.trim())throw Error("Building name cannot be empty");return(await h.post({name:m})).data},onSuccess:e=>{t.setQueryData(["buildings"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[...t,e]}),t.invalidateQueries({queryKey:["buildings"]}),v.oR.success("Building added successfully"),A(!1),y(""),k(""),E("")},onError:e=>{console.error("Failed to add building:",e),v.oR.error(e instanceof Error?e.message:"Failed to add building")}}),L=(0,p.n)({mutationFn:async e=>(await h.delete(e),e),onSuccess:e=>{t.setQueryData(["buildings"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter(t=>t.id!==e)}),t.invalidateQueries({queryKey:["buildings"]}),v.oR.success("Building deleted successfully"),A(!1),k(""),E("")},onError:e=>{console.error("Failed to delete building:",e),v.oR.error("Failed to delete building")}}),O=e=>{A(!0),z("delete"),R(e),E(""),k("")},q=()=>{if(!U(N)){E("Incorrect admin password. Please try again.");return}"add"===_?I.mutate():"delete"===_&&F&&L.mutate(F)},M=e=>null==a?void 0:a.includes("/admin/building/".concat(e.id));return P?(0,r.jsx)("div",{className:"flex justify-center items-center w-64",children:(0,r.jsx)(d.A,{className:"animate-spin"})}):(0,r.jsxs)("div",{className:"flex h-[90vh] fixed mt-24",onMouseEnter:()=>{D()},children:[(0,r.jsxs)("div",{className:"w-64 bg-gray-100 border-r p-4 flex flex-col",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Buildings"}),(0,r.jsx)(s.$,{variant:"outline",size:"icon",onClick:()=>{A(!0),z("add"),E(""),k("")},className:"hover:bg-gray-200",children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})]}),(0,r.jsx)("div",{className:"flex-grow",children:0===B.length?(0,r.jsx)("p",{className:"text-center text-gray-500",children:"No buildings"}):(0,r.jsx)("div",{className:"space-y-2",children:B.map(e=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-3 rounded cursor-pointer ".concat(M(e)?"bg-blue-100":"hover:bg-gray-200"),children:[(0,r.jsx)(j(),{href:"/admin/building/".concat(e.id),className:"w-full",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(c.A,{className:"h-5 w-5 text-gray-500"}),(0,r.jsx)("span",{children:e.name})]})}),(0,r.jsx)(s.$,{variant:"ghost",size:"icon",disabled:L.isPending,onClick:t=>{t.stopPropagation(),O(e.id)},children:(0,r.jsx)(u.A,{className:"h-4 w-4 text-red-500"})})]}),(0,r.jsx)("div",{className:"border-t border-gray-300 my-2"})]},e.id))})}),(0,r.jsx)("div",{className:"mt-auto pb-4",children:(0,r.jsx)(s.$,{onClick:e,variant:"outline",className:"w-full",children:"Log out"})})]}),(0,r.jsx)(n.lG,{open:C,onOpenChange:e=>{e||(E(""),k(""),"add"===_&&y("")),A(e)},children:(0,r.jsxs)(n.Cf,{children:[(0,r.jsx)(n.c7,{children:(0,r.jsx)(n.L3,{children:"add"===_?"Add New Building":"Delete Building Confirmation"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[S&&(0,r.jsx)(o.Fc,{variant:"destructive",children:(0,r.jsx)(o.TN,{children:S})}),"add"===_&&(0,r.jsx)(i.p,{placeholder:"Enter Building Name",value:m,onChange:e=>y(e.target.value)}),(0,r.jsx)(i.p,{type:"password",placeholder:"Enter Admin Password",value:N,onChange:e=>k(e.target.value),onKeyDown:e=>{"Enter"===e.key&&q()}}),(0,r.jsx)(s.$,{onClick:q,disabled:!N.trim()||"add"===_&&!m.trim(),children:"Confirm"})]})]})})]})}},2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>s});var r=a(5155);a(2115);var n=a(9434);function s(e){let{className:t,type:a,...s}=e;return(0,r.jsx)("input",{type:a,"data-slot":"input",className:(0,n.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...s})}},4165:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>u,Es:()=>f,L3:()=>p,c7:()=>g,lG:()=>o,rr:()=>m,zM:()=>d});var r=a(5155);a(2115);var n=a(5776),s=a(4416),i=a(9434);function o(e){let{...t}=e;return(0,r.jsx)(n.bL,{"data-slot":"dialog",...t})}function d(e){let{...t}=e;return(0,r.jsx)(n.l9,{"data-slot":"dialog-trigger",...t})}function l(e){let{...t}=e;return(0,r.jsx)(n.ZL,{"data-slot":"dialog-portal",...t})}function c(e){let{className:t,...a}=e;return(0,r.jsx)(n.hJ,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function u(e){let{className:t,children:a,...o}=e;return(0,r.jsxs)(l,{"data-slot":"dialog-portal",children:[(0,r.jsx)(c,{}),(0,r.jsxs)(n.UC,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...o,children:[a,(0,r.jsxs)(n.bm,{className:"ring-offset-background cursor-pointer focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,r.jsx)(s.A,{}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function g(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function f(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function p(e){let{className:t,...a}=e;return(0,r.jsx)(n.hE,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",t),...a})}function m(e){let{className:t,...a}=e;return(0,r.jsx)(n.VY,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",t),...a})}},4631:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},5365:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>o,TN:()=>d});var r=a(5155);a(2115);var n=a(2085),s=a(9434);let i=(0,n.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...n}=e;return(0,r.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,s.cn)(i({variant:a}),t),...n})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"alert-description",className:(0,s.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}},7383:(e,t,a)=>{"use strict";function r(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)e[r]=a[r]}return e}a.d(t,{A:()=>n});var n=function e(t,a){function n(e,n,s){if("undefined"!=typeof document){"number"==typeof(s=r({},a,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var o in s){if(s[o])i+="; "+o,!0!==s[o]&&(i+="="+s[o].split(";")[0])}return document.cookie=e+"="+t.write(n,e)+i}}return Object.create({set:n,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var a=document.cookie?document.cookie.split("; "):[],r={},n=0;n<a.length;n++){var s=a[n].split("="),i=s.slice(1).join("=");try{var o=decodeURIComponent(s[0]);if(r[o]=t.read(i,o),e===o)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){n(e,"",r({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,r({},this.attributes,t))},withConverter:function(t){return e(r({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(a)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})},9083:(e,t,a)=>{Promise.resolve().then(a.bind(a,2012))},9335:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,AuthProvider:()=>l});var r=a(5155),n=a(2115),s=a(5695),i=a(7383),o=a(9870);let d=(0,n.createContext)(null),l=e=>{let{children:t}=e,[a,l]=(0,n.useState)(null),[c,u]=(0,n.useState)(!1),[g,f]=(0,n.useState)(!0),p=(0,s.useRouter)(),m=async()=>{try{if(!i.A.get("token")){u(!1),l(null),f(!1);return}let e=await o.R.checkAuthStatus();e.user?(l(e.user),u(!0)):(l(null),u(!1),i.A.remove("token"))}catch(e){console.error("Auth verification failed:",e),l(null),u(!1),i.A.remove("token")}finally{f(!1)}},h=async()=>{try{await o.R.signout()}catch(e){console.error("Logout error:",e)}finally{i.A.remove("token"),l(null),u(!1),p.push("/")}};return(0,n.useEffect)(()=>{m()},[]),(0,r.jsx)(d.Provider,{value:{user:a,isAuthenticated:c,isLoading:g,login:e=>{i.A.set("token",e,{secure:!0,sameSite:"strict"}),m()},logout:h,checkAuth:m},children:t})},c=()=>{let e=(0,n.useContext)(d);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},9434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>s});var r=a(2596),n=a(9688);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,r.$)(t))}},9870:(e,t,a)=>{"use strict";a.d(t,{R:()=>n});var r=a(768);let n={login:async e=>(await r.S.post("/signin",e)).data,signup:async e=>(await r.S.post("/signup",e)).data,signout:async()=>(await r.S.post("/signout")).data,checkAuthStatus:async()=>(await r.S.post("/status")).data}}},e=>{var t=t=>e(e.s=t);e.O(0,[914,794,676,874,662,767,441,684,358],()=>t(9083)),_N_E=e.O()}]);