(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[490],{285:(e,t,a)=>{"use strict";a.d(t,{$:()=>l});var r=a(5155),s=a(2115),n=a(9708),i=a(2085),o=a(9434);let d=(0,i.F)("inline-flex items-center cursor-pointer justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow ",destructive:"bg-white border-[red] border text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:a,variant:s,size:i,asChild:l=!1,...c}=e,u=l?n.DX:"button";return(0,r.jsx)(u,{className:(0,o.cn)(d({variant:s,size:i,className:a})),ref:t,...c})});l.displayName="Button"},768:(e,t,a)=>{"use strict";a.d(t,{S:()=>n});var r=a(3464),s=a(7383);let n=r.A.create({baseURL:"https://api.aisigroup.ge/api",withCredentials:!0});n.interceptors.request.use(e=>{let t=s.A.get("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e})},2012:(e,t,a)=>{"use strict";a.d(t,{default:()=>k});var r=a(5155),s=a(4165),n=a(285),i=a(2523),o=a(5365),d=a(4631),l=a(4616),c=a(8136),u=a(2525),g=a(6715),f=a(9373),h=a(5041),m=a(768);let x={post:async e=>(await m.S.post("/add_building",e)).data,get:async()=>(await m.S.get("/buildings")).data,delete:async e=>(await m.S.delete("/delete_building/".concat(e))).data};var v=a(2115),p=a(6671),y=a(9335),b=a(6874),j=a.n(b),w=a(5695);function k(){let{logout:e}=(0,y.A)(),t=(0,g.jE)(),a=(0,w.usePathname)(),[m,b]=(0,v.useState)(""),[k,N]=(0,v.useState)(""),[A,S]=(0,v.useState)(!1),[C,_]=(0,v.useState)(""),[E,z]=(0,v.useState)(null),[F,P]=(0,v.useState)(null),{data:R=[],isLoading:B}=(0,f.I)({queryKey:["buildings"],queryFn:async()=>(await x.get()).data,staleTime:3e4,gcTime:3e5,retry:1,refetchOnWindowFocus:!0,refetchOnMount:!0}),L=(0,v.useCallback)(()=>{t.prefetchQuery({queryKey:["buildings"],queryFn:async()=>(await x.get()).data,staleTime:3e4})},[t]),q=e=>"Adminuser111"===e,M=(0,h.n)({mutationFn:async()=>{if(!m.trim())throw Error("Building name cannot be empty");return(await x.post({name:m})).data},onSuccess:e=>{t.setQueryData(["buildings"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return[...t,e]}),t.invalidateQueries({queryKey:["buildings"]}),p.oR.success("Building added successfully"),S(!1),b(""),N(""),_("")},onError:e=>{console.error("Failed to add building:",e),p.oR.error(e instanceof Error?e.message:"Failed to add building")}}),Q=(0,h.n)({mutationFn:async e=>(await x.delete(e),e),onSuccess:e=>{t.setQueryData(["buildings"],function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter(t=>t.id!==e)}),t.invalidateQueries({queryKey:["buildings"]}),p.oR.success("Building deleted successfully"),S(!1),N(""),_("")},onError:e=>{console.error("Failed to delete building:",e),p.oR.error("Failed to delete building")}}),$=e=>{S(!0),z("delete"),P(e),_(""),N("")},D=()=>{if(!q(k)){_("Incorrect admin password. Please try again.");return}"add"===E?M.mutate():"delete"===E&&F&&Q.mutate(F)},K=e=>null==a?void 0:a.includes("/admin/building/".concat(e.id));return B?(0,r.jsx)("div",{className:"flex justify-center items-center w-64",children:(0,r.jsx)(d.A,{className:"animate-spin"})}):(0,r.jsxs)("div",{className:"flex h-[90vh] fixed mt-24",onMouseEnter:()=>{L()},children:[(0,r.jsxs)("div",{className:"w-64 bg-gray-100 border-r p-4 flex flex-col",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:"Buildings"}),(0,r.jsx)(n.$,{variant:"outline",size:"icon",onClick:()=>{S(!0),z("add"),_(""),N("")},className:"hover:bg-gray-200",children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})]}),(0,r.jsx)("div",{className:"flex-grow",children:0===R.length?(0,r.jsx)("p",{className:"text-center text-gray-500",children:"No buildings"}):(0,r.jsx)("div",{className:"space-y-2",children:R.map(e=>(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center p-3 rounded cursor-pointer ".concat(K(e)?"bg-blue-100":"hover:bg-gray-200"),children:[(0,r.jsx)(j(),{href:"/admin/building/".concat(e.id),className:"w-full",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(c.A,{className:"h-5 w-5 text-gray-500"}),(0,r.jsx)("span",{children:e.name})]})}),(0,r.jsx)(n.$,{variant:"ghost",size:"icon",disabled:Q.isPending,onClick:t=>{t.stopPropagation(),$(e.id)},children:(0,r.jsx)(u.A,{className:"h-4 w-4 text-red-500"})})]}),(0,r.jsx)("div",{className:"border-t border-gray-300 my-2"})]},e.id))})}),(0,r.jsx)("div",{className:"mt-auto pb-4",children:(0,r.jsx)(n.$,{onClick:e,variant:"outline",className:"w-full",children:"Log out"})})]}),(0,r.jsx)(s.lG,{open:A,onOpenChange:e=>{e||(_(""),N(""),"add"===E&&b("")),S(e)},children:(0,r.jsxs)(s.Cf,{children:[(0,r.jsx)(s.c7,{children:(0,r.jsx)(s.L3,{children:"add"===E?"Add New Building":"Delete Building Confirmation"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[C&&(0,r.jsx)(o.Fc,{variant:"destructive",children:(0,r.jsx)(o.TN,{children:C})}),"add"===E&&(0,r.jsx)(i.p,{placeholder:"Enter Building Name",value:m,onChange:e=>b(e.target.value)}),(0,r.jsx)(i.p,{type:"password",placeholder:"Enter Admin Password",value:k,onChange:e=>N(e.target.value),onKeyDown:e=>{"Enter"===e.key&&D()}}),(0,r.jsx)(n.$,{onClick:D,disabled:!k.trim()||"add"===E&&!m.trim(),children:"Confirm"})]})]})})]})}},2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var r=a(5155);a(2115);var s=a(9434);function n(e){let{className:t,type:a,...n}=e;return(0,r.jsx)("input",{type:a,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},4165:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>u,Es:()=>f,L3:()=>h,c7:()=>g,lG:()=>o,rr:()=>m,zM:()=>d});var r=a(5155);a(2115);var s=a(5776),n=a(4416),i=a(9434);function o(e){let{...t}=e;return(0,r.jsx)(s.bL,{"data-slot":"dialog",...t})}function d(e){let{...t}=e;return(0,r.jsx)(s.l9,{"data-slot":"dialog-trigger",...t})}function l(e){let{...t}=e;return(0,r.jsx)(s.ZL,{"data-slot":"dialog-portal",...t})}function c(e){let{className:t,...a}=e;return(0,r.jsx)(s.hJ,{"data-slot":"dialog-overlay",className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function u(e){let{className:t,children:a,...o}=e;return(0,r.jsxs)(l,{"data-slot":"dialog-portal",children:[(0,r.jsx)(c,{}),(0,r.jsxs)(s.UC,{"data-slot":"dialog-content",className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...o,children:[a,(0,r.jsxs)(s.bm,{className:"ring-offset-background cursor-pointer focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,r.jsx)(n.A,{}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function g(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"dialog-header",className:(0,i.cn)("flex flex-col gap-2 text-center sm:text-left",t),...a})}function f(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"dialog-footer",className:(0,i.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...a})}function h(e){let{className:t,...a}=e;return(0,r.jsx)(s.hE,{"data-slot":"dialog-title",className:(0,i.cn)("text-lg leading-none font-semibold",t),...a})}function m(e){let{className:t,...a}=e;return(0,r.jsx)(s.VY,{"data-slot":"dialog-description",className:(0,i.cn)("text-muted-foreground text-sm",t),...a})}},4631:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(9946).A)("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},5365:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>o,TN:()=>d});var r=a(5155);a(2115);var s=a(2085),n=a(9434);let i=(0,s.F)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,n.cn)(i({variant:a}),t),...s})}function d(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"alert-description",className:(0,n.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",t),...a})}},9083:(e,t,a)=>{Promise.resolve().then(a.bind(a,2012))},9335:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,AuthProvider:()=>l});var r=a(5155),s=a(2115),n=a(5695),i=a(7383),o=a(9870);let d=(0,s.createContext)(null),l=e=>{let{children:t}=e,[a,l]=(0,s.useState)(null),[c,u]=(0,s.useState)(!1),[g,f]=(0,s.useState)(!0),h=(0,n.useRouter)(),m=async()=>{try{if(!i.A.get("token")){u(!1),l(null),f(!1);return}let e=await o.R.checkAuthStatus();e.user?(l(e.user),u(!0)):(l(null),u(!1),i.A.remove("token"))}catch(e){console.error("❌ Auth verification failed:",e),l(null),u(!1),i.A.remove("token")}finally{f(!1)}},x=async()=>{try{await o.R.signout()}catch(e){console.error("❌ Logout error:",e)}finally{i.A.remove("token",{path:"/",domain:void 0}),l(null),u(!1),h.push("/")}};return(0,s.useEffect)(()=>{m();let e=setInterval(()=>{c&&m()},3e5);return()=>clearInterval(e)},[]),(0,r.jsx)(d.Provider,{value:{user:a,authenticated:c,isLoading:g,login:e=>{i.A.set("token",e,{secure:!0,sameSite:"none",expires:1}),m()},logout:x,checkAuth:m},children:t})},c=()=>{let e=(0,s.useContext)(d);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},9434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>n});var r=a(2596),s=a(9688);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},9870:(e,t,a)=>{"use strict";a.d(t,{R:()=>n});var r=a(768),s=a(7383);let n={login:async e=>{try{let t=await r.S.post("/signin",e);return t.data.token&&s.A.set("token",t.data.token,{secure:!0,sameSite:"none",expires:1}),t.data}catch(e){throw console.error("❌ Login failed:",e),e}},signup:async e=>{try{return(await r.S.post("/signup",e)).data}catch(e){throw console.error("❌ Signup failed:",e),e}},signout:async()=>{try{let e=await r.S.post("/signout");return s.A.remove("token"),e.data}catch(e){throw console.error("❌ Signout error:",e),s.A.remove("token"),e}},checkAuthStatus:async()=>{try{return(await r.S.get("/status")).data}catch(e){throw console.error("❌ Auth status check failed:",e),e}}}}},e=>{var t=t=>e(e.s=t);e.O(0,[914,536,676,874,662,767,441,684,358],()=>t(9083)),_N_E=e.O()}]);